<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PromptShare Live</title>
    <!-- 마크다운 렌더링 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Socket.IO 클라이언트 -->
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="/style.css">
    <!-- 초기 로드 시 테마 깜빡임 방지용 인라인 스크립트 -->
    <script>
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script>
</head>
<body>
    <header class="app-header">
        <div class="header-inner">
            <div class="header-left">
                <h1>PromptShare <span>Live</span></h1>
                <div id="adminHeaderInfo" class="admin-header-info hidden">
                    <span class="url-badge">ROOM</span>
                    <span id="currentUrlTxt" class="url-txt">/live/...</span>
                </div>
            </div>
            <div class="header-right">
                <button id="themeToggleBtn" class="icon-btn" title="테마 변경">
                    <!-- Light / Dark 아이콘 토글에 쓰일 껍데기 -->
                    <svg id="themeIcon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg>
                </button>
                <button id="adminBtn" class="icon-btn" title="강사 로그인">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                </button>
                <div id="adminTools" class="admin-tools hidden">
                    <button id="copyInviteBtn" class="icon-btn" title="초대 링크 복사">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                    </button>
                    <button id="rotateUrlBtn" class="icon-btn text-warning" title="방 접속 경로 갱신">
                         <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                    </button>
                    <button id="clearAllBtn" class="icon-btn text-danger" title="대화 전체 강제 삭제">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- 상태 메시지 표시 영역 -->
        <div id="statusAlert" class="alert hidden">
            확인된 교육장 주소가 변경되었습니다. 새 주소를 강사님께 요청하세요.
        </div>
        
        <!-- 프롬프트 뷰어 (학생 기본 화면) -->
        <div class="viewer-container">
            <div id="messageList" class="message-list">
                <div class="empty-state" id="emptyState">
                    진행 중인 프롬프트가 없습니다.
                </div>
            </div>
        </div>

        <!-- 관리자 도구 패널 (iOS 스타일 입력창) -->
        <div id="adminPanel" class="admin-panel hidden">
            <div class="chat-input-wrapper">
                <textarea id="promptInput" rows="1" placeholder="메시지 또는 프롬프트 (마크다운 지원)"></textarea>
                <button id="sendBtn" class="send-icon-btn">
                    <svg viewBox="0 0 24 24" width="16" height="16" stroke="currentColor" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </div>
        </div>
    </main>

    <!-- 로그인 모달 -->
    <div id="loginModal" class="modal hidden">
        <div class="modal-content">
            <h2>강사 인증</h2>
            <p>방 관리를 위해 비밀번호를 입력해주세요.</p>
            <input type="password" id="passwordInput" placeholder="비밀번호를 입력하세요" autocomplete="off" (keyup.enter)="login()">
            <div class="modal-actions">
                <button id="cancelLoginBtn" class="btn">취소</button>
                <button id="loginBtn" class="btn">입장</button>
            </div>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>
