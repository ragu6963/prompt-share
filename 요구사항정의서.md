# [요구사항 정의서] PromptShare Live

AI 교육용 실시간 프롬프트 전달 서비스 (MVP)

### 프로젝트 개요

**목적**: 개인 강사 전용 단일 교육장에서 프롬프트를 실시간 배포하되, 접속 주소를 유동적으로 변경하여 보안과 편의성을 동시에 확보함.

**핵심 원칙**
* **단일 룸 & 유동 URL**: 서버 내 물리적인 방은 단 하나만 존재하지만, 해당 방에 접속하는 **URL 경로(예: `/live/random-id`)를 강사가 실시간으로 갱신(Rotate)** 할 수 있음.
* **비밀번호 기반 권한**: 서버 비밀번호를 아는 강사만 접속 URL을 새롭게 변경하거나 메시지를 작성할 수 있음.
* **경로 갱신 시 차단**: 강사가 URL을 변경하면 기존 구버전 URL로 접속 중인 학생은 더 이상 메시지를 수신할 수 없음.

### 최소 필수 기능 (Core Features)

**강사 (Host)**
* 접속 주소 갱신: 비밀번호 인증 후, 현재 교육장의 **접속 URL을 새로운 랜덤 경로로 즉시 변경**.
* 메시지 전송 및 관리: 활성화된 고유 경로 상에서 프롬프트 작성, 삭제 및 전체 초기화 수행.
* 초대 URL 공유: 새롭게 갱신된 접속 링크를 복사하여 학생들에게 전달.

**학생 (Guest)**
* 유효 URL 접속: 강사가 새롭게 갱신하여 전달해준 최신 링크로만 입장 및 실시간 확인 가능.
* 원클릭 복사: 공유된 각 프롬프트 옆의 버튼을 눌러 클립보드로 복사.

### 강사 권한 인증 및 URL 전환 설계

**URL 로테이션 로직**
* **고정 룸, 가변 경로**: 서버 메모리에는 `currentMessages = []`와 `currentRoomPath = 'uuid'`가 단 하나씩 존재함.
* **갱신 액션**: 강사가 'URL 갱신' 버튼을 누르면 `currentRoomPath`가 새로운 UUID로 바뀌며, 기존 경로로 들어오는 모든 요청은 404 또는 차단 처리됨.

**권한 및 데이터**
* **강사 인증**: 비밀번호를 통해 갱신 및 쓰기 권한을 유지하며, 로컬 스토리지를 통해 세션 지속.
* **데이터 휘발**: URL이 갱신되어도 메시지 내역은 유지할지, 혹은 갱신 시 자동으로 초기화할지 강사가 선택 가능 (기본은 갱신 시 초기화 권장).

### 기술 스택 (Minimal Stack)
**Frontend (Zero-Library)**
* **Vanilla JS**: 프레임워크 없는 순수 자바스크립트 및 DOM API 활용.
* **HTML5 / CSS3**: 빌드 도구 없는 표준 마크업 및 스타일링.
* **Socket.io Client**: 서버와의 실시간 통신을 위한 경량 클라이언트 라이브러리.

**Backend (Productivity Library)**
* **Node.js + Express**: 가볍고 빠른 API 서버 구축.
* **Socket.io**: 룸(Room) 기반 관리 및 실시간 양방향 통신.
* **In-memory**: 서버 내부 메모리 객체를 활용한 **완전 휘발성** 데이터 관리.

### 프로젝트 구조

```text
prompt-chat/
├── package.json      # 프로젝트 의존성 관리
├── server.js         # Node.js + Express + Socket.io 메인 서버
└── public/           # 프론트엔드 정적 파일
    ├── index.html    # 단일 뷰 구조 HTML
    ├── style.css     # UI 스타일 (Minimal)
    └── app.js        # Vanilla JS 및 소켓 통신 로직
```

### 데이터 관리 및 청소 정책

**완전 휘발성 저장 (Zero-Persistence)**
* **목록 유지**: 수업 중인 방의 프롬프트 기록은 서버 메모리(Map/Object)에만 임시 보관.
* **자동 비활성화(Cleanup)**: 마지막 활동(메시지 전송 등)으로부터 6시간 동안 활동이 없을 경우, 메모리에 임시 보관 중인 메시지 내역과 현재 세션 URL 정보가 모두 자동 초기화(비활성화)됨.
* **영구 보관 지양**: 수업 종료나 서버 재시작 시 모든 기록은 초기화되며, 별도의 DB 저장을 수행하지 않음.

### UI/UX 설계 (Minimal)

**단일 뷰 구조 (Single View)**
* **실시간 뷰어 (학생 기본 화면)**: 강사가 전송한 프롬프트 목록을 마크다운 스타일로 렌더링. 메시지 확인 및 원클릭 복사 버튼만 배치.
* **관리자 모드 활성화 (강사 인증)**: 강사가 자물쇠 아이콘 등 인증 버튼을 통해 비밀번호를 입력하면 강사 전용 UI 활성화.
* **강사 전용 도구 (관리자 모드)**: 텍스트 입력, 전송, 개별 삭제, 전체 대화 초기화, URL 갱신(Rotate) 및 초대 링크 복사 버튼 노출.
* **구버전 접근 안내**: 강사가 URL을 갱신하면, 이전 URL에 접속 중이던 학생들의 화면에는 접속이 해제되었음을 알리는 안내 메시지(예: 확인된 교육장 주소가 변경되었습니다)와 함께 소켓 연결이 차단됨.

### 비기능 요구사항
* **보안 및 접근 제어**: 강사가 URL을 갱신하는 즉시 구버전 URL은 접근 불가 처리하여 수업 보안 유지.
* **실시간성**: 소켓 통신을 통한 1초 이내 전역 동기화.
* **데이터 관리**: 서버 메모리 내 단일 배열만 사용하며, 명시적 초기화 또는 서버 재시작 시 삭제.

### 사용자 시나리오 (User Scenarios)

**강사 (Host) 시나리오**
* **갱신**: 수업 시작 전 비밀번호로 인증한 뒤, 'URL 갱신'을 눌러 오늘 사용할 새 링크를 생성합니다.
* **배포**: 생성된 최신 링크를 학생들에게 공유합니다.
* **진행**: 수업 중 프롬프트를 전송하고, 필요 시 특정 메시지를 삭제하거나 전체 초기화합니다.
* **정리**: 수업 종료 후 URL을 한 번 더 갱신하여 이전 참여자의 재접속을 원천 차단합니다.

**학생 (Guest) 시나리오**
* **입장**: 강사가 오늘 새로 공유해준 유효한 링크로 접속합니다.
* **수신**: 실시간으로 강사가 올려주는 프롬프트를 확인합니다.
* **활용**: 필요한 프롬프트 옆의 복사 버튼을 눌러 실습에 활용합니다.
* **연결 해제**: 강사가 보안을 위해 URL을 갱신하면, 실시간으로 연결이 끊어지며 올바른 새 링크를 다시 안내받으라는 메시지가 화면에 노출됩니다.

